name: Update Statistics from Private Repos

on:
  schedule:
    # Menjalankan setiap hari pada tengah malam UTC
    - cron: '0 0 * * *' 
  workflow_dispatch: # Memungkinkan eksekusi manual

jobs:
  update-cards:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      # 1. GENERATE STATISTIK CARD UTAMA (Metrics)
      - name: Generate Main GitHub Metrics
        uses: lowlighter/metrics@latest
        with:
          token: ${{ secrets.PRIVATE_REPO_TOKEN }} 
          # PERUBAHAN TAMPILAN: Menggunakan template flat
          template: classic 
          output_action: directory # FIX: Pastikan file tersimpan untuk commit
          filename: github-metrics.svg 
          
          # PLUGINS UTAMA
          base: header, activity, community 
          plugin_isocalendar: yes
          plugin_isocalendar_duration: full-year
          plugin_stargazers: yes
          plugin_habits: yes
          plugin_habits_from: 200 
          plugin_habits_charts: yes 
          
      # 2. GENERATE TOP LANGUAGES CARD
      - name: Generate Top Languages Card
        uses: lowlighter/metrics@latest
        with:
          token: ${{ secrets.PRIVATE_REPO_TOKEN }}
          # PERUBAHAN TAMPILAN: Menggunakan template flat
          template: classic
          output_action: directory # FIX: Pastikan file tersimpan untuk commit
          filename: github-top-langs.svg 
          base: "" 
          
          # PLUGINS BAHASA
          plugin_languages: yes
          plugin_languages_threshold: 0%
          plugin_languages_limit: 10
          plugin_languages_skipped: "HTML, CSS, Shell, Roff, YAML, Other"
          
      # 3. COMMIT PERUBAHAN KE REPO
      - name: Commit Files
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_message: "Automatic: Update GitHub metrics (Template Flat)"
